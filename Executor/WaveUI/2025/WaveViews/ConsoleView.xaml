<UserControl x:Class="Executor.WaveUI.WaveViews.ConsoleView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">

    <UserControl.Resources>
        <SolidColorBrush x:Key="WaveBlueLight" Color="#7CC4FF" />
        <SolidColorBrush x:Key="WaveBlueDeep" Color="#0D3B66" />
        <SolidColorBrush x:Key="WaveBlue" Color="#1DA1F2" />

        <Style x:Key="WaveThinScrollBar" TargetType="ScrollBar">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="#6FFFFFFF" />
            <Setter Property="Width" Value="3" />
            <Setter Property="Height" Value="3" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid Background="{TemplateBinding Background}" SnapsToDevicePixels="True">
                            <Track x:Name="PART_Track" IsDirectionReversed="True">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton x:Name="PART_DecreaseButton" Command="ScrollBar.PageUpCommand" Opacity="0" Focusable="False" />
                                </Track.DecreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb x:Name="Thumb" Background="{TemplateBinding Foreground}" Width="3" Margin="0" BorderThickness="0" Style="{x:Null}">
                                        <Thumb.Template>
                                            <ControlTemplate TargetType="Thumb">
                                                <Border Background="{TemplateBinding Background}" CornerRadius="2" BorderThickness="0" />
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton x:Name="PART_IncreaseButton" Command="ScrollBar.PageDownCommand" Opacity="0" Focusable="False" />
                                </Track.IncreaseRepeatButton>
                            </Track>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="Orientation" Value="Horizontal">
                                <Setter Property="Height" Value="3" />
                                <Setter Property="Width" Value="Auto" />
                                <Setter TargetName="PART_DecreaseButton" Property="Command" Value="ScrollBar.PageLeftCommand" />
                                <Setter TargetName="PART_IncreaseButton" Property="Command" Value="ScrollBar.PageRightCommand" />
                            </Trigger>
                            <Trigger Property="Orientation" Value="Vertical">
                                <Setter Property="Width" Value="3" />
                                <Setter Property="Height" Value="Auto" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="WaveThinScrollViewer" TargetType="ScrollViewer">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollViewer">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="8" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <ScrollContentPresenter Grid.Column="0" Grid.Row="0" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}" CanContentScroll="{TemplateBinding CanContentScroll}" />

                            <ScrollBar x:Name="PART_VerticalScrollBar" Grid.Column="1" Grid.Row="0"
                                       Orientation="Vertical"
                                       Maximum="{TemplateBinding ScrollableHeight}"
                                       ViewportSize="{TemplateBinding ViewportHeight}"
                                       Value="{TemplateBinding VerticalOffset}"
                                       Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}" />
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="WaveOpacitySlider" TargetType="Slider">
            <Setter Property="Focusable" Value="False" />
            <Setter Property="Height" Value="18" />
            <Setter Property="IsMoveToPointEnabled" Value="True" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Slider">
                        <Grid Height="18" VerticalAlignment="Center">
                            <Border Height="4" VerticalAlignment="Center" Background="{StaticResource WaveBlueLight}" CornerRadius="2" />

                            <Track x:Name="PART_Track" VerticalAlignment="Center">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Command="Slider.DecreaseLarge" Opacity="0" Focusable="False" />
                                </Track.DecreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb Width="14" Height="14" Background="{StaticResource WaveBlueDeep}">
                                        <Thumb.Template>
                                            <ControlTemplate TargetType="Thumb">
                                                <Ellipse Fill="{TemplateBinding Background}" />
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Command="Slider.IncreaseLarge" Opacity="0" Focusable="False" />
                                </Track.IncreaseRepeatButton>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ConsoleFilterButton" TargetType="RadioButton">
            <Setter Property="Height" Value="28" />
            <Setter Property="MinWidth" Value="90" />
            <Setter Property="Background" Value="#0E0E0E" />
            <Setter Property="Foreground" Value="#EDEDED" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Padding" Value="12,0" />
            <Setter Property="FocusVisualStyle" Value="{x:Null}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}" CornerRadius="6" Opacity="0.92" RenderTransformOrigin="0.5,0.5">
                            <Border.RenderTransform>
                                <ScaleTransform x:Name="BdScale" ScaleX="1" ScaleY="1" />
                            </Border.RenderTransform>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Opacity" Value="1" />
                            </Trigger>
                            <Trigger Property="IsChecked" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation Storyboard.TargetName="Bd" Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)" To="#1DA1F2" Duration="0:0:0.12" />
                                            <DoubleAnimation Storyboard.TargetName="Bd" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.12" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation Storyboard.TargetName="Bd" Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)" To="#0E0E0E" Duration="0:0:0.12" />
                                            <DoubleAnimation Storyboard.TargetName="Bd" Storyboard.TargetProperty="Opacity" To="0.92" Duration="0:0:0.12" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="BdScale" Storyboard.TargetProperty="ScaleX" To="0.94" Duration="0:0:0.06" />
                                            <DoubleAnimation Storyboard.TargetName="BdScale" Storyboard.TargetProperty="ScaleY" To="0.94" Duration="0:0:0.06" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="BdScale" Storyboard.TargetProperty="ScaleX" To="1" Duration="0:0:0.18">
                                                <DoubleAnimation.EasingFunction>
                                                    <BackEase EasingMode="EaseOut" Amplitude="0.6" />
                                                </DoubleAnimation.EasingFunction>
                                            </DoubleAnimation>
                                            <DoubleAnimation Storyboard.TargetName="BdScale" Storyboard.TargetProperty="ScaleY" To="1" Duration="0:0:0.18">
                                                <DoubleAnimation.EasingFunction>
                                                    <BackEase EasingMode="EaseOut" Amplitude="0.6" />
                                                </DoubleAnimation.EasingFunction>
                                            </DoubleAnimation>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ConsoleSearchBoxBorder" TargetType="Border">
            <Setter Property="Background" Value="#0E0E0E" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="CornerRadius" Value="0" />
            <Setter Property="Height" Value="28" />
            <Setter Property="Padding" Value="10,0" />
        </Style>

        <Style x:Key="ConsoleListBoxStyle" TargetType="ListBox">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled" />
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBox">
                        <Border Background="{TemplateBinding Background}">
                            <ScrollViewer Focusable="False" Padding="0" VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}">
                                <ItemsPresenter />
                            </ScrollViewer>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <DataTemplate x:Key="ConsoleLogItemTemplate">
            <Border Background="Transparent" Padding="8,6" CornerRadius="6">
                <TextBlock FontFamily="{DynamicResource WaveMonoFontFamily}" FontSize="{Binding Value, ElementName=FontSizeSlider}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis">
                    <Run Text="[" Foreground="#5D6066" />
                    <Run Text="{Binding Timestamp}" Foreground="#5D6066" />
                    <Run Text="] " Foreground="#5D6066" />
                    <Run Text="[" Foreground="{Binding LevelColor}" />
                    <Run Text="{Binding Level}" Foreground="{Binding LevelColor}" />
                    <Run Text="]" Foreground="{Binding LevelColor}" />
                    <Run Text="[" Foreground="#9AA0A6" />
                    <Run Text="{Binding Source}" Foreground="#9AA0A6" />
                    <Run Text="] " Foreground="#9AA0A6" />
                    <Run Text="{Binding Message}" Foreground="#EDEDED" />
                </TextBlock>
            </Border>
        </DataTemplate>

        <Style x:Key="ConsoleListBoxItemStyle" TargetType="ListBoxItem">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="Margin" Value="0,0,0,4" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <Border x:Name="Bd" Background="Transparent" CornerRadius="8">
                            <ContentPresenter />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#101010" />
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#141414" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </UserControl.Resources>

    <Grid Background="#000000" Margin="0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Border Background="#0C0C0C" BorderBrush="#40FFFFFF" BorderThickness="0,0,0,1" CornerRadius="0" Padding="12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock x:Name="DetailTitle" Text="Console" Foreground="#EDEDED" FontWeight="SemiBold" FontSize="14" FontFamily="{DynamicResource WaveHeadingFontFamily}" VerticalAlignment="Center" />

                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,10,0">
                        <RadioButton x:Name="FilterAllButton" GroupName="ConsoleLevelFilter" Style="{StaticResource ConsoleFilterButton}" Background="#0E0E0E" IsChecked="True" Checked="FilterAll_OnChecked">
                            <TextBlock x:Name="FilterAllText" Text="ALL" FontWeight="SemiBold" FontFamily="{DynamicResource WaveTitleFontFamily}" FontSize="12" VerticalAlignment="Center" />
                        </RadioButton>
                        <RadioButton x:Name="FilterInfoButton" GroupName="ConsoleLevelFilter" Style="{StaticResource ConsoleFilterButton}" Background="#0E0E0E" Margin="8,0,0,0" Checked="FilterInfo_OnChecked">
                            <TextBlock x:Name="FilterInfoText" Text="INFO" FontWeight="SemiBold" FontFamily="{DynamicResource WaveTitleFontFamily}" FontSize="12" VerticalAlignment="Center" />
                        </RadioButton>
                        <RadioButton x:Name="FilterWaringButton" GroupName="ConsoleLevelFilter" Style="{StaticResource ConsoleFilterButton}" Background="#0E0E0E" Margin="8,0,0,0" Checked="FilterWaring_OnChecked">
                            <TextBlock x:Name="FilterWaringText" Text="WARING" FontWeight="SemiBold" FontFamily="{DynamicResource WaveTitleFontFamily}" FontSize="12" VerticalAlignment="Center" />
                        </RadioButton>
                        <RadioButton x:Name="FilterErrorButton" GroupName="ConsoleLevelFilter" Style="{StaticResource ConsoleFilterButton}" Background="#0E0E0E" Margin="8,0,0,0" Checked="FilterError_OnChecked">
                            <TextBlock x:Name="FilterErrorText" Text="ERROR" FontWeight="SemiBold" FontFamily="{DynamicResource WaveTitleFontFamily}" FontSize="12" VerticalAlignment="Center" />
                        </RadioButton>
                    </StackPanel>

                    <Border Style="{StaticResource ConsoleSearchBoxBorder}" Width="220" Margin="0,0,10,0">
                        <Grid>
                            <TextBox x:Name="SearchBox" Background="Transparent" Foreground="#EDEDED" BorderThickness="0" FontSize="12" CaretBrush="#FFFFFF"
                                     VerticalContentAlignment="Center" Padding="0,0,20,0" TextChanged="SearchBox_OnTextChanged" />
                            <TextBlock x:Name="SearchPlaceholder" Text="Search..." Foreground="#6F7782" FontSize="12" Margin="2,0,0,0" VerticalAlignment="Center" IsHitTestVisible="False">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Text, ElementName=SearchBox}" Value="">
                                                <Setter Property="Visibility" Value="Visible" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Text, ElementName=SearchBox}" Value="{x:Null}">
                                                <Setter Property="Visibility" Value="Visible" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                            <Path Fill="#9AA0A6" Width="12" Height="12" Stretch="Uniform" HorizontalAlignment="Right" VerticalAlignment="Center" Opacity="0.8" Margin="0,0,2,0"
                                  Data="M9.5 8.5l3.5 3.5-1 1-3.5-3.5v-.5l-.2-.2A5 5 0 1 1 9.5 8.5zm-4.5 0A3.5 3.5 0 1 0 5 1.5a3.5 3.5 0 0 0 0 7z" />
                        </Grid>
                    </Border>

                    <Grid VerticalAlignment="Center">
                        <Slider x:Name="FontSizeSlider" Minimum="10" Maximum="16" Value="12" Width="140" VerticalAlignment="Center" Style="{StaticResource WaveOpacitySlider}" ValueChanged="FontSizeSlider_OnValueChanged" />
                        <Popup x:Name="FontSizePopup" PlacementTarget="{Binding ElementName=FontSizeSlider}" Placement="Relative" AllowsTransparency="True" StaysOpen="True" IsOpen="False">
                            <Border x:Name="FontSizePopupBorder" Background="#0E0E0E" CornerRadius="6" Padding="8,4" Opacity="0" RenderTransformOrigin="0.5,1">
                                <Border.RenderTransform>
                                    <TranslateTransform x:Name="FontSizePopupTranslate" Y="6" />
                                </Border.RenderTransform>
                                <TextBlock x:Name="FontSizePopupText" Text="12" Foreground="#EDEDED" FontFamily="{DynamicResource WaveMonoFontFamily}" FontSize="12" />
                            </Border>
                        </Popup>
                    </Grid>
                </StackPanel>
            </Grid>
        </Border>

        <Border Grid.Row="1" Background="#0C0C0C" BorderThickness="0" CornerRadius="0" Padding="12">
            <Grid>
                <RichTextBox x:Name="LogBox" Background="#0E0E0E" Foreground="#EDEDED" BorderThickness="0" IsReadOnly="True" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled"
                             FontFamily="{DynamicResource WaveMonoFontFamily}" FontSize="{Binding Value, ElementName=FontSizeSlider}" SelectionBrush="#3355B7FF">
                    <RichTextBox.Resources>
                        <Style TargetType="ScrollBar" BasedOn="{StaticResource WaveThinScrollBar}" />
                        <Style TargetType="ScrollViewer" BasedOn="{StaticResource WaveThinScrollViewer}" />
                    </RichTextBox.Resources>
                </RichTextBox>

                <Border x:Name="ScrollToBottomHost" Background="Transparent" HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,0,0,14" Opacity="0" Visibility="Collapsed" IsHitTestVisible="False">
                    <Button x:Name="ScrollToBottomButton" Click="ScrollToBottomButton_OnClick" Background="#1DA1F2" Foreground="#FFFFFF" BorderThickness="0" Padding="18,10" MinHeight="38" Cursor="Hand" FocusVisualStyle="{x:Null}" OverridesDefaultStyle="True" Style="{x:Null}">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="Bd" Background="#1DA1F2" BorderBrush="#33000000" BorderThickness="1" CornerRadius="3" Opacity="{TemplateBinding Opacity}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="2" />
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Bd" Property="Background" Value="#249FF0" />
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter TargetName="Bd" Property="Background" Value="#1787CD" />
                                        <Setter Property="Opacity" Value="0.92" />
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                        <TextBlock x:Name="ScrollToBottomText" Text="Scroll to bottom" Foreground="#FFFFFF" FontSize="13" FontFamily="{DynamicResource WaveTitleFontFamily}" FontWeight="SemiBold" />
                    </Button>
                </Border>
            </Grid>
        </Border>
    </Grid>
</UserControl>
